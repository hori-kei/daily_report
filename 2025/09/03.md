# 取り組んだ課題一覧

- 現場で使えるDjangoの教科書(第5章 ビュー)

# わかったこと

- get_context_dataはテンプレートに渡すコンテキストをカスタマイズするためのメソッド
- super().grt_context_data()は親クラスのget_context_dataをオーバーライドしている。
- superを記述しないとDjangoが自動で入れてくれる情報が全部消える。
- 汎用ビュー(ListViewなど)にmodel = Bookと書くと裏でBook.objects.all()というBookモデルで作成されたオブジェクトを全部取得してきてテンプレートでこのオブジェクトを表示するためにはobject_listもしくは小文字のモデル名_listという変数名を使用することでテンプレート表示できる
- object_listもbook_listも入っている情報は一緒
- context_object_name = 'books'とするとobject_listと小文字のモデル名_listではなくbooksがテンプレート内でobject_listもbook_listをして、object_listもbook_listは使えなくなる
- 汎用ビューで明示的にテンプレートを指定したいときはtemplate_name変数をオーバーライドする。
- クラスでのテンプレートをレンダリングする方法は関数ビューの時みたいにrenderを使って返さなくてもよく、class内で
    
    ```python
    class BookListView(ListView):
        model = Book
    ```
    
    と書けば自動でレンダリングまでしてくれる
    
- 下記のようなコードがあればget_context_data内にはobject_listとbook_listが中に含まれている。
- ListView や DetailView などは object_list, object など自動で渡してくれるがTemplateView だけは一切そういう自動変数がない
- extra_contextをオーバーライドして静的(定数)な変数を渡す
- model = BookだとすべてのBookオブジェクトが取得されるがもし公開中のオブジェクトだけの取得などなにか条件を指定したうえでのオブジェクトを取得するにはqueryset = Book.objects.filter(published=True)のようにする
    - model = Bookだとobject_list = Book.objects.all(), book_list = Book.objects.all()だけどもしqueryset = Book.objects.filter(published=True)だとobject_listtにはBook.objects.filter(published=True)のオブジェクトが入る
    - このときmodel = bookは記述してないのでbook_listは使えない
- get_template_namesメソッドは使うテンプレートを動的に決めたいときに使う
    - 例えばユーザーがスタッフだった場合と違った場合にretuenするテンプレート先を変える
        
        ```python
        class BookListView(ListView):
            model = Book
        
            def get_template_names(self):
                if self.request.user.is_staff:
                    return ['book/staff_list.html']
                return ['book/list.html']
        ```
        
- get_queryset() はリクエストやユーザーなどの 動的な条件に応じて切り替えたいときに使う
- Webアプリケーションでのログイン済みの状態とは下記２つの状態のこと
    - ユーザーが本人確認されている(認証)
    - そのログイン状態がページ移動後も維持される(セッション)
- Webアプリケーションでログイン状態を維持するのに使われている技術はCookieとセッション
    - Cookie:ブラウザ側にセッションIDを保存できる場所
    - セッション:サーバー側で「ログイン中のユーザー情報」などを管理する仕組み
- request.userにはログイン中のユーザー情報(Userインスタンス)もしくは未ログイン(AnonymousUser)情報が入っている
- authenticateは認証でloginは送られてきたrequestと認証済みの変数を紐づける。
- LoginRequiredMixinは未ログインのユーザーがアクセスしようとしたときに、ログインページにリダイレクトさせるクラス
# 次やること

- 現場で使えるDjangoの教科書(第6章 モデル)

# 感じたこと

- 眠すぎる。。。

# 学習時間

-  2.0時間